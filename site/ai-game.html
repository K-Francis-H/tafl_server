<!DOCTYPE html>
<html>
	<head>
		<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon"/>
		<meta charset="utf-8">
		<title>Tafl Games</title>
		<script src="todo_TaflBoard.js"></script>
		<script src="todo_TaflRenderer.js"></script>
		<script src="MonteCarloAI.js"></script>
		<script src="RandomAI.js"></script>
		<script src="MinimaxAI.js"></script>
		<script src="todo_TaflGameAI.js"></script>
		<script src="EaldfaederRules.js"></script>
		<script src="FetlarRules.js"></script>
		<script src="CopenhagenRules.js"></script>
		<script src="ClevelandRules.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", function(){
				//var board = new TaflBoard(TaflBoard.BRANDUBH);
				//var renderer = new TaflRenderer(document.getElementById("canvas"));
				//renderer.draw(board);
				//var editor = new TaflBoardEditor(document.getElementById("canvas"), TaflBoard.BRANDUBH);
				var url = new URL(document.URL);
				var variant = url.searchParams.get("variant");
				var playerColor = url.searchParams.get("playerColor");
				var rules = resolveRuleSet(url.searchParams.get("rules"));
				if(variant && playerColor){
					variant = variant.toUpperCase();
					var aiGame = new TaflGameAI(document.getElementById("canvas"), TaflBoard[variant], playerColor, rules);
				}else{
					//bad...
					//redirect to main page
					window.location.replace("/");
				}

				function resolveRuleSet(value){
					switch(value){
						case "fetlar":
							return new FetlarRules();
						case "copenhagen":
							return new CopenhagenRules();
						case "ealdfaeder":
							return new EaldfaederRUles();
						case "cleveland":
						default:
							return new ClevelandRules();
					}
				}
			});
		</script>
	</head>
	<body>
		<a href="/">New Game</a>
		<center>
			<h1 id="variant"></h1>
			<h3 id="playing-as"></h3>
			<h3 id="to-play"></h3>
			<div id="game-container">
				<canvas id="canvas" draggable="true" width=800 height=800></canvas>
				<h4 id="share-label" style="display:none;">Join Link:</h4>
				<input id="shareable-join-link" readonly style="display:none;"/>
				<button id="copy-button" style="display:none;">Copy</button>
			</div>
		</center>
	</body>
</html>
